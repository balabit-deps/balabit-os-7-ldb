From fb005204b4248012f49e31e4c2c452a667f3fc87 Mon Sep 17 00:00:00 2001
From: Andrew Bartlett <abartlet@samba.org>
Date: Mon, 4 Feb 2019 11:22:50 +1300
Subject: [PATCH 3/6] CVE-2019-3824 ldb: Improve code style and layout in
 wildcard processing

BUG: https://bugzilla.samba.org/show_bug.cgi?id=13773

Signed-off-by: Andrew Bartlett <abartlet@samba.org>
---
 lib/ldb/common/ldb_match.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/common/ldb_match.c b/common/ldb_match.c
index b49085286a2..e332ba0da53 100644
--- a/common/ldb_match.c
+++ b/common/ldb_match.c
@@ -333,9 +333,11 @@ static int ldb_wildcard_compare(struct ldb_context *ldb,
 
 				g = memmem(haystack,
 					   haystacklen,
-					(const uint8_t *)cnk.data,
-					cnk.length);
-				if (g) p = g;
+					   (const uint8_t *)cnk.data,
+					   cnk.length);
+				if (g) {
+					p = g;
+				}
 			} while(g);
 		}
 		val.length = val.length - (p - (uint8_t *)(val.data)) - cnk.length;
-- 
2.17.1
